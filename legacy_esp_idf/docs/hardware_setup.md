# 硬件安装指南

## 所需材料

| 材料 | 数量 | 规格说明 |
|------|------|----------|
| ESP32-H2 开发板 | 1 | 推荐 ESP32-H2-DevKitM-1 |
| SG90 舵机 | 1 | 或其他兼容 50Hz PWM 的舵机 |
| 轻触开关 | 1 | 6x6mm 四脚按键 |
| 杜邦线 | 若干 | 母对母 |
| 5V 电源 | 1 | 用于舵机供电 (可选) |

## 引脚定义

### ESP32-H2 DevKitM-1 引脚

```
                    ┌─────────────┐
              3V3 ──┤ 1        40 ├── 5V
              GND ──┤ 2        39 ├── GND
             IO12 ──┤ 3        38 ├── IO11
             IO13 ──┤ 4        37 ├── IO10
             IO14 ──┤ 5        36 ├── IO9  ◄── 按键
             IO22 ──┤ 6        35 ├── IO8
             IO23 ──┤ 7        34 ├── IO7
             IO24 ──┤ 8        33 ├── IO6
             IO25 ──┤ 9        32 ├── IO5  ◄── 舵机 PWM
             IO26 ──┤ 10       31 ├── IO4
             IO27 ──┤ 11       30 ├── IO3
              EN  ──┤ 12       29 ├── IO2
             IO0  ──┤ 13       28 ├── IO1
                    └─────────────┘
```

## 接线说明

### 舵机接线

舵机一般有三根线:
- **红色**: VCC (电源正极)
- **棕色/黑色**: GND (电源负极)
- **黄色/橙色**: PWM 信号线

```
接线方式:

[ESP32-H2]              [舵机]
   IO5  ──────────────── PWM (黄/橙)
   GND  ──────────────── GND (棕/黑)
   5V   ──────────────── VCC (红)

注意: 如果舵机功率较大，建议使用独立 5V 电源供电
      并将电源 GND 与 ESP32-H2 GND 连接
```

### 按键接线

```
[ESP32-H2]              [按键]
   IO9  ──────────────── 引脚1
   GND  ──────────────── 引脚2

注意: 代码中已配置 GPIO9 内部上拉，按下时为低电平
```

## 供电建议

### 方案一: USB 供电 (适合小型舵机)

```
USB ──> ESP32-H2 DevKit ──> 舵机
                5V ──────> VCC
               GND ──────> GND
```

### 方案二: 独立供电 (推荐)

```
                 ┌──────────────┐
  USB ────────── │ ESP32-H2     │
                 │              │
                 │ IO5 ─────────┼───> PWM
                 │ GND ─────────┼──┬─> GND
                 └──────────────┘  │
                                   │
  5V 电源 ──────────────> VCC ─────┘
            GND ─────────────────────>
```

## 舵机角度调整

根据实际安装位置，可能需要调整以下参数:

```c
// main/main.c 中的角度配置

#define SERVO_MIN_ANGLE      20     // ON状态 (按下)
#define SERVO_MAX_ANGLE      180    // OFF状态 (松开)
```

### 调试步骤

1. 先设置较小的角度范围测试 (如 90-100 度)
2. 观察舵机旋转方向是否正确
3. 逐步调整到合适的角度范围
4. 确保不会卡住或超出物理限制

## 外壳安装

### 安装要点

1. **固定舵机**: 使用双面胶或螺丝固定舵机底座
2. **对准开关**: 调整舵机摇臂与目标开关的相对位置
3. **预留空间**: 确保舵机转动时不会碰到其他物体
4. **走线**: 将杜邦线整理好，避免缠绕

### 示意图

```
侧视图:
          ┌─────────┐
          │ 墙面开关 │
          │   ○     │  <── 目标按钮
          └────┬────┘
               │
     ┌─────────┴─────────┐
     │    舵机摇臂       │
     │  ╭───────────╮    │
     │  │   舵机    │    │
     │  ╰───────────╯    │
     └───────────────────┘
          底座/支架
```

## 故障排除

### 舵机抖动

- 原因: 供电不足或 PWM 信号不稳定
- 解决: 使用独立 5V 电源供电

### 舵机无反应

1. 检查接线是否正确
2. 测量 PWM 引脚是否有输出 (用示波器或万用表)
3. 尝试更换 GPIO 引脚

### 角度不准确

- 调整 `DUTY_AT_0_DEG` 和 `DUTY_AT_180_DEG` 参数
- 不同舵机的占空比范围可能略有差异

## 安全提示

1. 调试时注意舵机转动范围，避免夹伤手指
2. 确保所有连接牢固，避免短路
3. 如果长时间不使用，建议断开舵机电源
